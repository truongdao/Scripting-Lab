<!DOCTYPE html>
<html>
<head>
  <title>Scripting Lab document</title>
</head>
<body>

<!---------------------------------------------------------------------------->
<div id="div_menu">

<h1>Index</h1>
  <ol>
	<li><a href="#div_about"		>About</a></li>
	<li><a href="#div_installation"	>Installation</a></li>
	<li><a href="#div_tutorials"	>Tutorials</a>
		<ol type="a">
			<li>Say 'helloworld'</li>
			<li>GUI Interface</li>
			<li>Using Libraries</li>
			<li>Use cases</li>
		</ol>
	</li>
	<li><a href="#div_references"	>References</a>
		<ol type="a">
			<li>Built-in functions</li>
			<li>External libraries</li>
		</ol>
	</li>
	<li><a href="#div_technical"	>Technical description</a>
		<ol type="a">
			<li>System architecture</li>
			<li>Externing built-in functions</li>
		</ol>
	</li>
	<li><a href="#div_contribution"	>Contribution</a></li>
	
  </ol>
</div> <!--div "div_menu"-->
<hr>

<!---------------------------------------------------------------------------->
<div id="div_about">
<h1>About</h1>

<p>
Tài liệu này dùng cho việc giới thiệu bộ công cụ <b>Scripting Lab</b> dể xây dựng chương trình ứng dụng. Tài liệu cũng hướng dẫn cách tạo và chạy chương trình, cách mở rộng thư viện, bảng tra chức năng của một số thư viện. Kiến trúc của bộ công cụ cũng được đưa ra nhằm giúp mọi người hiểu và cải tiến trong tương lai.
</p>

<p>
<b>Scripting Lab</b> là một phần mềm cung cấp chức năng biên tập và tạo môi trường thực thi các chương trình được viết bằng ngôn ngữ <code>JavaScript</code> trên máy tính như một ứng dụng desktop (not <strike>web application</strike>). Mục tiêu của <b>Scripting Lab</b> là tổng quan. Quan điểm của nó là đơn giản hóa việc phát triển chương trình bằng cách khuyến khích đóng gói các mô-đun cấp thấp thành các thư viện và chỉ được tích hợp khi cần.<br>
Một số mô-đun giúp các lập trình viên (hoặc ai đó khác) xây dựng, thực thi, giám sát các quy trình phát triển sản phẩm (<code>phần mềm</code>) một cách nhanh chóng và hiệu quả. Thậm chí công đoạn trong quy trình đó có thể được lập trình để hoàn thành tự động khi các bước tiến hành là rõ ràng.
</p>

<p>
Công cụ này tận dụng lợi thế dễ tiếp cận, mềm dẻo và sửa đổi ứng dụng dễ dàng của ngôn ngữ <code>JavaScript</code> làm ngôn ngữ chạy nền.
</p>

</div><!--div "div_about"-->


<!---------------------------------------------------------------------------->
<div id="div_installation">
<h1>Installation</h1>
Có 2 cách cài đặt chương trình chính: dạng portable, chạy file <code>.jar</code> ở thư mục bất kỳ hoặc
thực thi file script có đuôi <code>.jsx</code> (khi đã cài đặt chương trình ở đâu đó từ trước).
<ol type="1">
	<h3><li>Run as portable program </li></h3>
	
	Đảm bảo rằng trong thư mục có cả tệp thực thi <code>ScriptingLab.jar</code> và thư mục <code>ScriptingLab.data</code>. Thư mục <code>ScriptingLab.data</code> để chứa các thư viện mở rộng và chương trình chính.<br>
	Quá trình nạp các tệp khi khởi động:<br><br>
	<center><img src="resources/startup_files.jpg" 
		alt="ScriptingLab.jar ->config.js ->libs ->main.js"></center>
	
	<h3><li>Execute files with association <code>.jsx</code></li></h3>
		<ol>
		<li>	Chép 3 tệp <code>ScriptingLab.jar, run.bat, test.jsx </code> và thư mục <code>			ScriptingLab.data</code> vào một thư mục bất kỳ.<br><br>
		<center><img src="resources/installation_files.jpg" 
			alt="ScriptingLab.jar, run.bat, ScriptingLab.data"></center>
		</li>
		<li> Sửa nội dung tệp <code>run.bat</code>. Thay đường dẫn tới thư mục chứa những tệp cài đặt này vào vị trí được tô đậm. Ở đây thư mục cài đặt của tôi là <code>D:\my\Proj_TaskWizard\TestPlace</code> nên nội dung tệp <code>run.bat</code> như sau:<br><br>
		<center><img src="resources/edit_run_bat.jpg" 
			alt="run.bat content"></center>
		</li>
		<li> Đăng ký các tệp có đuôi <code>.jsx</code> mở bằng chương trình. 
		Nhấp phải chuột vào tệp <code>test.jsx</code> chọn <b>Open with...</b>,
		Nhấp <b>Browse...</b> trong hộp thoại Open with, trỏ tới tệp <code>run.bat</code> này trong hộp thoại chọn tệp, OK.<br><br>
		
		<center><img src="resources/setup_open_with.jpg" 
			alt="run.bat file"></center>
		</li><br>	
		Cài đặt đã hoàn tất. Giờ các tệp có đuôi <code>.jsx</code> ở vị trí bất kỳ sẽ luôn được mở bằng chương trình. Tệp <code>.jsx</code> là một tệp <code>javascript</code>. Giờ hãy kiểm tra bằng cách nháy đôi vào tệp <code>test.jsx</code>
		</ol>
		
	<h3><li>Run from command line (less common)</li></h3>
	
	
</div> <!--div "div_installation"-->


<!---------------------------------------------------------------------------->
<div id="div_tutorials">
<h1>Tutorials</h1>

Hướng dẫn này được tổ chức theo mức độ thú vị dần. Chúc vui! :(<br>

		<ol type="1">
			<!---------------------------------------------------------------------------->
			<h3><li>Say 'helloworld'</li></h3>
			
			Đầu tiên hãy đảm bảo rằng chương trình đã được cài đặt đúng yêu cầu. 
			Có thể kích hoạt chương trình bằng cách chạy <code>ScriptingLab.jar</code> (dạng portable) hoặc mở một tệp <code>.jsx</code> trống.
			
			<br>
			<hr>
			Chương trình helloworld đầu tiên: <br><br>
			1. Double click "ScriptingLab.jar"<br>
			2. Nhập <code>outln('hello world!')</code> trong khung soạn thảo code màu đen<br>
			3. Nhấp <b>Run</b><br>
			4. Kiểm tra khung console phía dưới hiện dòng chữ <code>"hello world!"</code><br><br>
			<center><img src="resources/tut1_hellow.JPG" alt="Output hello world"></center> 
			<hr>
			Chương trình helloworld đầu tiên đơn giản là in ra console một dòng chữ.<br>
			<!---------------------------------------------------------------------------->
			<h3><li>GUI Interface</li></h3>			
			Giải thích vài chức năng của giao diện:<br><br>
			<ul>
				<li>Nút <b>Run</b>: Thực hiện đoạn chương trình có trên cửa <code>Code editor</code> (không phải thực thi tệp <code>.js</code> trên thanh địa chỉ.				</li>
				<li>Nút <b>Save</b>: Lưu nội dung của <code>Code editor</code> vào tệp trên thanh địa chỉ.				</li>
				<li><b>Thanh địa chỉ</b>: Nếu nhập địa chỉ bằng tay, nhấn <code>Enter</code> để nạp nội dung tệp được trỏ tới lên khung soạn thảo.</li>
				<li>Nút <b>Browser</b>: Mở hộp thoại chọn tệp.				</li>
				<li>Nút <b>?</b>: Thông tin chương trình.				</li>
				<li>Nút <b>Clear</b>: Xóa nội dung khung <code>Output console </code>, có thể gọi lệnh clear() để làm điều đó.</li>
				<li><b>Code editor</b>: Khung soạn thảo code. </li>
				
				<li><b>Output console</b>: Khung xuất dữ liệu khi gọi hàm outln(),out(), đầu ra chuẩn của <code>Scripting Lab</code>. Đây cũng nên là ngõ ra của các lỗi mà người sử dụng cuối cần biết, một số lỗi cấp thấp không được bắt (catch) sẽ xuất hiện trong <code>console</code> của hệ điều hành. Lưu ý: Scripting Lab không chủ ý thay các output stream mặc định của <code>java.lang.System</code></li>
				
				<li><b>Phím tắt</b> (cho <code>Code editor</code>):<br><br>
				<table border=1 style="width:100%">
				<tr>
				<td><code>Alt+Enter</code></td>
				<td>thực thi toàn bộ code trên khung soạn thảo.</td>
				</tr>
				
				<tr>
				<td><code>Bôi đen code, Alt+Enter</code></td>
				<td>thực thi đoạn code được bôi đen.</td>
				</tr>	
				
				<tr>
				<td><code>Shift+Enter</code></td>
				<td>thực thi dòng code đang biên tập (có dấu nhắc chuột). Đặc biệt hữu ích khi thử nghiệm một dòng code, bạn có thể gọi <code>clear()</code> ở bất cứ đâu.</td>
				</tr>	
				
				</table>
				
				</p></li>
			</ul>
			
			<!---------------------------------------------------------------------------->
			<h3><li>Using Libraries</li></h3>
			Có hai loại thư viện: thư viện <code>Java .jar</code> và thư viện <code>javascript .js</code>. Để nạp một thư viện jar, sử dụng hàm <code>loadjar( jar_path )</code>. Để nạp thư viện js, sử dụng <code>eval( js_path )</code>. <br>
			Đường dẫn tới các thư viện có thể là tuyệt đối, tương đối theo vị trí chương trình được cài đặt (lookup) hay tương đối theo vị trí chương trình được kích hoạt (bởi chạy tệp <code>.jsx</code>). <br>
			Để nạp các thư viện khi chương trình khởi động, cần đăng ký trong tệp <code>config.js</code>. Bước đăng ký chỉ đơn giản là gọi hàm <code>eval() hay loadjar()</code>.<br><br>
			*Cần lưu ý về thư mục làm việc: thư mục chứa tệp <code>.jsx</code> mà kích hoạt chương trình là thư mục chính, thư mục cài đặt có tệp <code>ScriptingLab.jar</code> là thư mục lookup( nếu không tìm thấy thư viện trong thư mục chính, chương trình sẽ tìm trong thư mục lookup). Tính năng lookup folder chỉ hỗ trợ cho phương thức <code>eval() và loadjar()</code>, không hỗ trợ cho các kiểu đọc file thông thường khác.<br>
			
			<!---------------------------------------------------------------------------->
			<h3><li>Use cases</li></h3>
		</ol>
</div> <!--div "div_tutorials"-->


<!---------------------------------------------------------------------------->
<div id="div_references">
<h1>References</h1>

	<ol type="1">
		<!---------------------------------------------------------------------------->
		<h3><li>Built-in functions</li></h3>
			
			<ul>
			<li><!-- library description------------------------------------------------->
			
				<code><font color="BLUE">
				<b>builtins.js</b></font></code> <br><br>
				
				Thư viện này cung cấp những hàm nhập xuất dữ liệu căn bản nhất cũng và các hàm thao tác hệ thống như nạp một thư viện hay tương tác các đối tượng của javascript engine với các đối tượng của Java.<br>
				Thư viện này thì được nạp trong quá trình khởi động hệ thống. Tệp mã nguồn script cũng được nén cùng gói chương trình nên người sử dụng không thấy được tệp <code>builtins.js</code><br><br>

				<!-- functions description-->
				
				<table border="1" style="width:100%">
					<tr><td bgcolor="aqua"><b>Modifier and Type</b></td> 
					<td bgcolor="aqua"><b>Description</b></td></tr>
					
					<tr><td><b><code>
					Object
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function convert( jso_name, jv_classpath_str )
					</b></code></a><br><br>
					Tạo đối tượng java mới có java interface là <code>jv_classpath_str</code> và nội dung là một javascript object <code>jso_name</code> theo tên.
					</td></tr>

					<tr><td><b><code>
					Object
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function find( var_name )
					</b></code></a><br><br>
					Tìm và trả về một đối tượng javascript bởi chuổi string <code>var_name</code>có tên của nó. Cung cấp cho người dùng phương pháp truy cập biến javascript bằng tên động.
					</td></tr>
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function copy(var_name, ref_obj_name)
					</b></code></a><br><br>
					Tạo một biến toàn cục javascript đặt tên theo <code>var_name</code> và giá trị khởi tạo là một javascript object có tên <code>ref_obj_name</code>
					</td></tr>
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function disableGUI(option)
					</b></code></a><br><br>
					Tắt giao diện Window hoặc mở lại, tùy <code>option</code> là <code>true/false</code>.
					</td></tr>
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function eval( js_path )
					</b></code></a><br><br>
					Nạp và thực thi một tệp <code>.js</code> tại đường dẫn <code>js_path</code>, thường thì đó là một thư viện.<br>
					*<code>js_path</code> có thể là đường dẫn tuyệt đối, tương đối của thư mục hiện hành hay tương đối của thư mục looup (thư mục cài đặt).
					
					</td></tr>
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function loadjar( jar_url )
					</b></code></a><br><br>
					Thêm một tệp thư viện <code>.jar</code> tại đường dẫn <code>jar_url</code> vào <code>JVM classpath</code>. Từ đây các gói trong thư viện thể được <code>import</code> trong môi trường javascript. Bước này được coi như là "nạp một thư viện gốc".<br>
					*<code>js_path</code>
					</td></tr>
					
					<tr><td><b><code>
					boolean
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					<strike>function loadclass( module_name, jar_url, class_path )</strike>
					</b></code></a><br><br>
					(bỏ! dùng <code>loadjar</code> thay vì)<br>
					Nạp và tạo một đối tượng javascript <code>module_name</code>tương ứng đối tượng java có <code>class_path</code> trong một thư viện <code>.jar</code> tại đường dẫn <code>jar_url</code>.
					</td></tr>

					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function out( msg )
					</b></code></a><br><br>
					In một chuổi <code>msg</code> ra màn hình console (của Scripting Lab hay JVM, tùy cấu hình).
					</td></tr>

					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function outln( msg )
					</b></code></a><br><br>
					In ra một chuổi <code>msg</code> trên dòng mới của màn hình console (của Scripting Lab hay JVM, tùy cấu hình).
					</td></tr>

					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function clear()
					</b></code></a><br><br>
					Xóa nội dung màn hình console của Scripting Lab.
					</td></tr>

					<tr><td><b><code>
					string
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function input()
					</b></code></a><br><br>
					Hiện cửa sổ nhập một chuỗi string và trả về.
					</td></tr>		

					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					function exit()
					</b></code></a><br><br>
					Thoát khỏi chương trình.
					</td></tr>
					
					
				</table><br><br>
				
				<!-- functions in detail-->

				<b>Details</b><br>
				<font color="BLUE"> cần bổ sung... </font>
				<hr><br>
				
			</li>
			</ul>
			
		<!---------------------------------------------------------------------------->
		<h3><li>External libraries</li></h3>
		
			<ul>
			<li><!-- library description------------------------------------------------->
			
				<code><font color="BLUE">
				<b>cmd.js</b></font></code> <br><br>
				
				Thư viện cung cấp hàm để thực thi các lệnh <code>command line</code> của Windows. <br>
				* Có nhiều hàm bị Windows hạn chế không cho gọi từ chương trình.
				<br><br>

				<!-- functions description-->
				
				<table border="1" style="width:100%">
					<tr><td bgcolor="aqua"><b>Modifier and Type</b></td> 
					<td bgcolor="aqua"><b>Description</b></td></tr>
					
					<tr><td><b><code>
					string
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					function cmd( cmd_line )
					</b></code></a><br><br>
					Thực thi một lệnh <code>command line</code> của Windows và trả về kết quả thực hiện.
					</td></tr>	
					
					
				</table><br><br>
				
				<!-- functions in detail-->

				<b>Details</b><br><br>
				<ul>
				
				<li>
					<div id="cmd_cmd">
					<code><b>function cmd( cmd_line ) : string </b></code><br><br>
					Các lệnh này được hỗ trợ bởi Command.exe. Ví dụ : <code>cmd('help')...</code>
					</div>
				</li>
				
				</ul>
				<hr><br>
			</li>
			
			<li><!-- library description------------------------------------------------->
			
				<code><font color="BLUE">
				<b>excel.js</b></font></code> <br><br>
				
				Thư viện này cung cấp các đối tượng và phương thức để thao tác với dữ liệu trên tệp Excel (.xls).<br>
				Chuỗi truy cập <code>Mở tệp excel -> mở sheet -> truy cập cell</code>, tương ứng với các đối tượng <code>Xls -> Book -> Sheet -> Cell</code> được cung cấp bởi thư viện này.<br>
				Các đối tượng <code>Book, Sheet, Cell</code> không chứa các hàm thao tác trực tiếp với các thành phần của file Excel mà chỉ cung cấp các hàm lấy về đối tượng con, cháu của nó. Thay vào đó chúng sử dụng kỹ thuật đóng gói để chứa một đối tượng "thật" tên là <code>.r</code> có khả năng thao tác trên trên file excel. Đối tượng <code>.r</code> này là một thực thể Java của thư viện POI. <br><br>
				
				<table border="1">
				<tr><td bgcolor="chartreuse">excel.js object</td> <td bgcolor="chartreuse">POI object</td></tr>
				<tr><td>Xls</td> 
						<td><code>none</code></td></tr>
				<tr><td>Book.r</td> 
						<td><code><a style="text-decoration:none;" href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFWorkbook.html">
						org.apache.poi.hssf.usermodel.HSSFWorkbook</a></code></td></tr>
				<tr><td>Sheet.r</td> 
						<td><code><a style="text-decoration:none;"href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html">
						org.apache.poi.hssf.usermodel.HSSFSheet</a></code></td></tr>				
				<tr><td>Cell.r</td> 
						<td><code><a style="text-decoration:none;"href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFCell.html">
						org.apache.poi.hssf.usermodel.HSSFCell</a></code></td></tr>				
								
				</table><br>
				
				Ví dụ:<code>
				
				<br>var book = Xls.open('input.xls');
				<br>var sheet = book.sheet(0);
				<br>var cell = sheet.cell( 0, 0);
				<br>outln(cell.r.toString());
				<br><br></code>
				
				Chương trình sẽ in ra nội dung cell ở dòng 0, cột 0, sheet đầu tiên của file excel 'input.xls'. Chú ý <code>cell.r</code> trả về đối tượng <code>java Cell</code> của thư viện <code>POI, toString()</code> là hàm của <code>java Cell</code>, hãy tra bảng tham khảo của thư viện này để biết các chức năng được cung cấp.<br><br>

				<!-- functions description-->
				
				<table border="1" style="width:100%">
					<tr><td bgcolor="aqua"><b>Modifier and Type</b></td> 
					<td bgcolor="aqua"><b>Description</b></td></tr>
					
					
					<!-------------------------------------------->
					<tr><td><b><code>
					Book
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Xls.open( file_path )
					</b></code></a><br><br>
					Mở một tệp .xls tại đường dẫn <code>file_path</code> và trả về đối tượng <code>Book</code> để thao tác.
					</td></tr>	
					
					
					<!-------------------------------------------->
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.save()
					</b></code></a><br><br>
					Lưu những thay đổi trên đối tượng <code>Book</code> này xuống tệp Excel.
					</td></tr>						

					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.saveAs( str_path)
					</b></code></a><br><br>
					Lưu đối tượng <code>Book</code> đang làm việc xuống một tệp Excel khác có tên <code>str_path</code>.
					</td></tr>	
					
					<tr><td><b><code>
					Sheet
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.sheet ( id )
					</b></code></a><br><br>
					Mở một <code>Sheet</code> theo tên của nó hay chỉ số thứ tự. Có thể là <code>book.sheet(0)</code> hoặc <code>book.sheet('Sheet1')</code>.
					</td></tr>		

					<tr><td><b><code>
					Sheet[]
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.sheets ()
					</b></code></a><br><br>
					Trả về toàn bộ các <code>Sheet</code> mà <code>Book</code> đang có.
					</td></tr>							

					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.cell ( sheet_id, row, col )
					</b></code></a><br><br>
					Trả về một <code>Cell</code> tại dòng <code>row</code>, cột <code>col</code>, tại <code>Sheet</code> có mã <code>sheet_id</code> (thứ tự hoặc tên) trong <code>Book</code> đang mở. (Truy xuất nhanh)
					</td></tr>	
					
					<tr><td><b><code>
					Cell[]
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.cells ( sheet_id)
					</b></code></a><br><br>
					Trả về toàn bộ <code>Cell</code> trong <code>Sheet</code> có mã <code>sheet_id</code> (thứ tự hoặc tên) trong <code>Book</code> đang mở.(Truy xuất nhanh)
					</td></tr>
					
					<tr><td><b><code>
					HSSFWorkbook
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Book.r
					</b></code></a><br><br>
					Đối tượng <code><a style="text-decoration:none;" href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFWorkbook.html">
						org.apache.poi.hssf.usermodel.HSSFWorkbook</a></code>
					</td></tr>	

					
					<!-------------------------------------------->
					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Sheet.cell ( row, col )
					</b></code></a><br><br>
					Trả về <code>Cell</code> ở dòng <code>row</code>, cột <code>col</code> trong <code>Sheet</code> đang mở.
					</td></tr>							
					
					<tr><td><b><code>
					Cell[]
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Sheet.cells ( )
					</b></code></a><br><br>
					Trả về toàn bộ <code>Cell</code> trong <code>Sheet</code> đang mở.
					</td></tr>		

					<tr><td><b><code>
					Sheet
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Sheet.right ( offset )
					</b></code></a><br><br>
					Lấy một Sheet bên phải và cách Sheet hiện tại số <code>offset</code> sheets.
					</td></tr>	

					<tr><td><b><code>
					Sheet
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Sheet.left ( offset )
					</b></code></a><br><br>
					Lấy một Sheet bên trái và cách Sheet hiện tại số <code>offset</code> sheets.
					</td></tr>	
					
					<tr><td><b><code>
					HSSFSheet
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Sheet.r
					</b></code></a><br><br>
					Đối tượng <code><a style="text-decoration:none;"href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html">
						org.apache.poi.hssf.usermodel.HSSFSheet</a></code>
					</td></tr>		


					<tr><td><b><code>
					Book
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.book
					</b></code></a><br><br>
					Trả về đối tượng Book đang chứa Sheet đó.
					</td></tr>	
					
					<!-------------------------------------------->
					<tr><td><b><code>
					HSSFCell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.r
					</b></code></a><br><br>
					Đối tượng <code><a style="text-decoration:none;"href="https://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFCell.html">
						org.apache.poi.hssf.usermodel.HSSFCell</a></code>
					</td></tr>						

					<tr><td><b><code>
					Sheet
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.sheet
					</b></code></a><br><br>
					Trả về đối tượng Sheet đang chứa Cell đó.
					</td></tr>	
					
					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.down ( offset )
					</b></code></a><br><br>
					Lấy một Cell phía dưới và cách cell hiện tại số <code>offset</code> dòng.
					</td></tr>							
					

					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.right ( offset )
					</b></code></a><br><br>
					Lấy một Cell bên phải và cách cell hiện tại số <code>offset</code> cột.
					</td></tr>							
					

					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.up ( offset )
					</b></code></a><br><br>
					Lấy một Cell phía trên và cách cell hiện tại số <code>offset</code> dòng.
					</td></tr>											
					

					<tr><td><b><code>
					Cell
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.left ( offset )
					</b></code></a><br><br>
					Lấy một Cell bên trái và cách cell hiện tại số <code>offset</code> cột.
					</td></tr>			

					<tr><td><b><code>
					boolean
					</code></b></td> <td><a href="#builtins_convert" style="text-decoration:none;"><code><b>
					Cell.empty ( )
					</b></code></a><br><br>
					Kiểm tra một java Cell đó null hoặc trống.
					</td></tr>			

					
				</table><br><br>
				
				<!-- functions in detail-->

				<b>Details</b><br>
				<font color="BLUE"> cần bổ sung... </font>
				<hr><br>
			</li>

			<li><!-- library description------------------------------------------------->
			
				<code><font color="BLUE">
				<b>forms.js</b></font></code> <br><br>
				
				Thư viện cung cấp phương thức để xây dựng một biểu mẫu nhập dữ liệu có giao diện.<br>
				
				Ví dụ:<br><code>
				<pre>
var form1 = new Form([
	{'0': Label('Name:'),  name: TextField('Truong'),  '1':  CheckBox('Male') },
	{'1': Label('Age:'),   age:  TextField(''),        '':   Label('*required')},   ]);
		
form1.append(
	[Confirm('OK'),  Confirm('Cancel')]     );
	
form1.show();

if(form1.ret == 'OK')
	outln('Form submitted!\tname: '+form1.rows[0]['name'].value());
if(form1.ret == 'Cancel')
	outln('Form cancel!');
if(form1.ret == null)
	outln('Form ignored!');			
				</pre></code>
				
				Form is shown:<br>
				<center><img src="resources/forms_ref_ex.JPG"></center>

				<br><br>
				<!-- functions description-->
				
				<table border="1" style="width:100%">
					<tr><td bgcolor="aqua"><b>Modifier and Type</b></td> 
					<td bgcolor="aqua"><b>Description</b></td></tr>
					
					<tr><td><b><code>
					Form
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					new  Form( ls_items )
					</b></code></a><br><br>
					Khởi tạo danh sách các phần tử trong biểu mẫu từ <code>ls_items</code>.<br>
					Đó là một mảng các đối tượng javascript (định dạng nhìn giống JSON), mỗi phần tử của mảng đại diện cho một dòng; mỗi dòng là một đối tượng (hoặc mảng) mà các phần tử của nó đều có thuộc tính <code>.r</code> là một đối tượng <code>Java</code> dẫn xuất từ lớp <code>javax.swing.JComponent</code>.
					</td></tr>	
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Form.append( item )
					</b></code></a><br><br>
					Chèn một dòng <code>item</code>vào cuối danh sách.<br>
					Dòng này phải là một mảng đơn hoặc đối tượng có điều kiện như một dòng được mô tả trong đối tượng <code>ls_items</code> được mô tả trên.
					</td></tr>	
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Form.append_1( item )
					</b></code></a><br><br>
					Chèn một dòng <code>item</code> vào trước dòng cuối trong danh sách.<br> Dùng trong trường hợp đã thêm các nút xác nhận "OK" hoặc "Cancel" vào dòng cuối mà vẫn muốn mở rộng danh sách thuộc tính.
					</td></tr>	
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Form.show( )
					</b></code></a><br><br>
					Hiển thị Form và vô hiệu hóa giao diện chính.<br>
					Sau khi Form đã được đóng lại, kiểm tra <code>Form.ret</code> để xem lý do nó đã bị đóng lại.
					</td></tr>						
					
					<tr><td><b><code>
					void
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Form.hide( )
					</b></code></a><br><br>
					Ẩn Form đi.<br>
					(Hiếm khi dùng!)
					</td></tr>						

					
					<!--------------------------------->
					<tr><td><b><code>
					Component
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Component( )
					</b></code></a><br><br>
					Giao diện chung nhất của các đối tượng có thể thêm vào Form.<br>
					Các thuộc tính phải có:<br>
					<ul>
					
					<li><code>up</code></li>: tham chiếu đối tượng cha, thuộc tính này chỉ cần khai báo, nó sẽ được truyền giá trị bởi đối tượng nào sử dụng component này. Hữu ích khi xử lý sự kiện.
					
					<li><code>r</code></li>: Đối tượng Java cung cấp giao diện thật, phải dẫn xuất từ <code>javax.swing.JComponent</code> hoặc <code>java.awt.Component</code>
					
					<li><code>value() : string</code></li>: Hàm trả về giá trị /trạng thái của đối tượng, được gọi bởi người sử dụng Form</code>			
					</td></tr>	
					
					
					<!--------------------------------->
					<tr><td><b><code>
					Button
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Button( value )
					</b></code></a><br><br>
					Trả về đối tượng <code>Button</code> với nhãn <code>value</code> có thể đặt vào Form, chúng thì chứa một <code>Java JButton</code> ở trong. <code>Button.value()</code> trả về nhãn của <code>Button</code>. Đối tượng này không được cài sự kiện trước, có thể thêm sau theo ý người sử dụng.
					</td></tr>						
					
					
					<!--------------------------------->
					<tr><td><b><code>
					Confirm
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Confirm( value )
					</b></code></a><br><br>
					Trả về đối tượng <code>Confirm</code> với nhãn <code>value</code> có thể đặt vào Form, chúng là một Button được cài sự kiện để khi nhấn, chúng sẽ ẩn Form và trả đặt nhãn của nó <code>Confirm.value()</code> vào <code>Form.ret</code> như giá trị trả về.
					</td></tr>		

					
					<!--------------------------------->
					<tr><td><b><code>
					Label
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					Label( value )
					</b></code></a><br><br>
					Trả về đối tượng <code>Label</code> với nhãn <code>value</code> có thể đặt vào Form để dẫn giải, chúng thì chứa một <code>Java JLabel</code> ở trong. <code>JLabel.value()</code> trả về nhãn của <code>Label</code>.
					</td></tr>	

					
					<!--------------------------------->
					<tr><td><b><code>
					TextField
					</code></b></td> <td><a href="#cmd_cmd" style="text-decoration:none;"><code><b>
					TextField( value )
					</b></code></a><br><br>
					Trả về đối tượng <code>TextField</code> để nhập giá trị khởi tạo với <code>value</code> có thể đặt vào Form, chúng thì chứa một <code>Java JTextField</code> ở trong. <code>JTextField.value()</code> trả về nội dung của <code>TextField</code>.
					</td></tr>						
					
					
				</table><br><br>
				
				<!-- functions in detail-->

				<b>Details</b><br>
				<font color="BLUE"> cần bổ sung... </font>
				<hr><br>
				
				<hr><br>
			</li>			
			</ul>		
	</ol>	

</div> <!--div "div_references"-->


<!---------------------------------------------------------------------------->
<div id="div_technical">
<h1>Technical description</h1>
	<ol>
	<h3><li>System</li></h3>
		<ol>
		<h3><li>Model</li></h3>
		
		<center><img src="resources/plugin_structure.jpg" alt="plugin_struct"></center>
		<hr>
		Về cơ bản Scripting Lab là bộ công cụ kết nối javascript engine (Rhino) ra môi trường ngoài như một ứng dụng desktop. Hệ thống phân cấp thành 3 tầng:
		<ul>
		<li><b>Scripting Lab</b> là chương trình chính viết bằng Java, nó thì chứa một js engine bên trong và hệ thống giao diện cũng như các hàm xây dựng sẵn, nhiều hàm cho phép chương trình js tương tác với chính js engine (điều này có thể gây nhiều mối nguy hiểm) giúp nó có thể mở rộng chức năng một cách dễ dàng.</li>
		<li><b>lib</b> Các thư viện mở rộng có thể là tệp js hay jar hoặc kết hợp. Chúng được nạp vào hệ thống một cách hoàn toàn linh động bởi các lệnh xuất phát từ chương trình java script.</li>
		<li><b>app</b> là tầng ứng dụng. Chương trình chính thường chỉ thể hiện như là các thao tác liên quan đến nghiệp vụ. Các thao tác này thì phải được cung cấp bởi các thư viện trong lớp <b>lib</b>. Điều này đảm bảo sự rành mạch và rõ ràng của chương trình</li>
		</ol>
		
		<h3><li>Program components</li></h3>
		<hr>
		<center><img src="resources/tech_components.jpg" alt="components"></center>
		<hr>
		<ul>
			<li>Bắt đầu từ <code>Main.java</code> nó thì chứa tham chiếu của hầu hết các thành phần trong chương trình. Hàm <code>main()</code> nhiệm vụ chính là khởi tạo engine, GUI.</li>
			<li><code>EngineLoader.java</code> khởi tạo engine và load thư viện built-in cũng như cung cấp dịch vụ cơ bản <code>loadJar</code>.</li>
			<li><code>ScriptingLabGUI.java</code> chứa đựng đối tượng <code>console output, code editor</code> có thể chứa nội dung html. Tương lai có thể mở rộng chức năng tô màu keywords.</li>
			<li><code>Console.java</code> chứa đựng giao diện chuẩn cho giao diện console của chương trình. Nếu đối tượng <code>ScriptingLabGUI</code> bị vô hiệu chúng sẽ cho xuất dữ liệu sang console của Windows.</li>
			<li><code>builtins.java</code> giao diện kết nối giữa thư viện <code>builtins.js</code> với chương trình. Về cơ bản nó chỉ gọi các functions của những components khác và expose chúng cho script engine. Tên hàm trong <code>builtins.java</code> giống trong <code>builtins.js</code> như một quy ước.</li>
			<li><code>Constant.java</code> chứa các tham số hệ thống.</li>
			
		</ul>
	<h3><li>Building libraries</li></h3>
		<ol>
		<h3><li>Model</li></h3>
		
		<center><img src="resources/load_extlib.jpg" alt="load_extlib"></center>
		<center>(Nạp một thư viện)</center>
		
		<h3><li>Guidelines</li></h3>
		
		</ol>
	<h3><li>Extending built-in functions</li></h3>
	</ol>
</div> <!--div "div_technical"-->


<!---------------------------------------------------------------------------->
<div id="div_contribution">
<h1>Contribution</h1>
Người sử dụng có thể tùy ý tải, sử dụng, sửa đổi mã nguồn, phân phối cho mục tiêu cá nhân mà không cần xin phép tác giả.<br>
Website:	<a href="https://sites.google.com/site/scriptinglab">https://sites.google.com/site/scriptinglab</a><br><br>

Source: 	<a href="https://github.com/truongdao/Scripting-Lab">https://github.com/truongdao/Scripting-Lab</a><br>
Contact: <a href="mailto:doctdao@gmail.com">doctdao@gmail.com</a>
<p><br><br><br><br>
<center>Copyright(c) 2015 Truong Dao</center>
</p>
</div> <!--div "div_contribution"-->


</body>
</html>